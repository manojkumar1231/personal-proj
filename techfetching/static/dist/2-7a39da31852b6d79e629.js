webpackJsonp([2],{1158:function(e,t,a){"use strict";function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case o:return(0,d.default)({},e,{loading:!0});case i:return(0,d.default)({},e,{loading:!1,loaded:!0,messages:t.result.data.reverse()});case c:return(0,d.default)({},e,{loading:!1,loaded:!1,error:t.error});case f:return(0,d.default)({},e,{messages:e.messages.concat(t.message)});default:return e}}function s(e){return e.chat&&e.chat.loaded}function u(){return{types:[o,i,c],promise:function(e){return e.app.service("messages").find({query:{$sort:{createdAt:-1},$limit:25}})}}}function n(e){return{type:f,message:e}}Object.defineProperty(t,"__esModule",{value:!0});var l=a(2),d=function(e){return e&&e.__esModule?e:{default:e}}(l);t.default=r,t.isLoaded=s,t.load=u,t.addMessage=n;var o="redux-example/chat/LOAD",i="redux-example/chat/LOAD_SUCCESS",c="redux-example/chat/LOAD_FAIL",f="redux-example/chat/ADD_MESSAGE",p={loaded:!1,messages:[]}},1159:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.withStore=t.withApp=void 0;var s=a(1160),u=r(s),n=a(1161),l=r(n);t.withApp=u.default,t.withStore=l.default},1160:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(415),s=a(1),u=function(e){return e&&e.__esModule?e:{default:e}}(s),n=(0,r.getContext)({app:u.default.any});t.default=n,e.exports=t.default},1161:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(415),s=a(1),u=function(e){return e&&e.__esModule?e:{default:e}}(s),n=(0,r.getContext)({store:u.default.any});t.default=n,e.exports=t.default},420:function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s,u,n,l,d=a(97),o=r(d),i=a(98),c=r(i),f=a(30),p=r(f),m=a(3),h=r(m),v=a(31),g=r(v),_=a(4),y=r(_),x=a(5),M=r(x),b=a(2),S=r(b),E=a(0),A=r(E),O=a(1),w=r(O),k=a(20),C=a(1158),j=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(C),D=a(1159),L=(s=(0,k.connect)(function(e){return{user:e.auth.user,messages:e.chat.messages}},(0,S.default)({},j)))(u=(0,D.withApp)((l=n=function(e){function t(){var e,a,r,s,u=this;(0,h.default)(this,t);for(var n=arguments.length,l=Array(n),d=0;d<n;d++)l[d]=arguments[d];return a=r=(0,y.default)(this,(e=t.__proto__||(0,p.default)(t)).call.apply(e,[this].concat(l))),r.state={message:"",error:null},r.handleSubmit=function(){var e=(0,c.default)(o.default.mark(function e(t){return o.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,r.props.app.service("messages").create({text:r.state.message});case 4:r.setState({message:"",error:!1}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0),r.setState({error:e.t0.message||!1});case 11:case"end":return e.stop()}},e,u,[[1,7]])}));return function(t){return e.apply(this,arguments)}}(),s=a,(0,y.default)(r,s)}return(0,M.default)(t,e),(0,g.default)(t,[{key:"componentDidMount",value:function(){this.props.app.service("messages").on("created",this.props.addMessage)}},{key:"componentWillUnmount",value:function(){this.props.app.service("messages").removeListener("created",this.props.addMessage)}},{key:"render",value:function(){var e=this,t=this.props,a=t.user,r=t.messages,s=this.state.error;return A.default.createElement("div",{className:"container"},A.default.createElement("h1",null,"Chat"),a&&A.default.createElement("div",null,A.default.createElement("ul",null,r.map(function(e){return A.default.createElement("li",{key:"chat.msg."+e._id},e.sentBy.email,": ",e.text)})),A.default.createElement("form",{onSubmit:this.handleSubmit},A.default.createElement("input",{type:"text",ref:function(t){e.message=t},placeholder:"Enter your message",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})}}),A.default.createElement("button",{className:"btn",onClick:this.handleSubmit},"Send"),s&&A.default.createElement("div",{className:"text-danger"},s))))}}]),t}(E.Component),n.propTypes={app:w.default.shape({service:w.default.func}).isRequired,user:w.default.shape({email:w.default.string}).isRequired,addMessage:w.default.func.isRequired,messages:w.default.arrayOf(w.default.object).isRequired},u=l))||u)||u;t.default=L,e.exports=t.default}});